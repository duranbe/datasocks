<!DOCTYPE html>
<html lang="en">

<head>
  
  <title>Login</title>

    <!-- Custom fonts for this template-->

      <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
      <!-- Custom styles for this template-->
      <link href="bootstrap/css/sb-admin-2.min.css" rel="stylesheet">
      
      <!-- Bootstrap core JavaScript-->
      <script src="bootstrap/vendor/jquery/jquery.min.js"></script>
      <script src="bootstrap/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    
      <!-- Core plugin JavaScript-->
      <script src="bootstrap/vendor/jquery-easing/jquery.easing.min.js"></script>
    
      <!-- Custom scripts for all pages-->
      <script src="bootstrap/js/sb-admin-2.min.js"></script>
    
    
      <!-- Page level plugins -->
      <script src="bootstrap/vendor/chart.js/Chart.min.js"></script>
    

      <script src="js/getCookie.js"></script>

      
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

</head>

<body class="bg-gradient-primary">

  <div class="container">
    
    <!-- Outer Row -->
    <div class="row justify-content-center">

      <div class="col-xl-10 col-lg-12 col-md-9">

        <div class="card o-hidden border-0 shadow-lg my-5">
          <div class="card-body p-0">
            <!-- Nested Row within Card Body -->
            <div class="row">
              
              <div class="col-lg-12">
                <div class="p-5">
                  <div class="text-center">
                    <h1 class="h4 text-gray-900 mb-4">Login to Datasocks</h1>
                  </div>
    
      <form id="LoginForm">
        <div class="form-group">
          <label >Email</label>
        <input id="id_email" name="email"  type="text" class="form-control" >
          </div>
        <div class="form-group">
          <label >Password </label>
      <input id="id_password" name="password" type="password" class="form-control" >
      </div>
      
      
        
        </form>

          <button class="btn btn-primary" type="button "onclick="sendLogin()">Login</button>
            
                  <div class="text-center">
                    <p>First time login ? Check your env file</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
    <a href="https://townhall.hashnode.com/build-with-linode-hackathon-june-2022">Made for Linode x Hashnode Hackathon</a>
  </div>

  
</body>
<script type="text/javascript">
  const auth_token = getCookie('auth_token');
	if(auth_token != null && auth_token !== 'undefined' ){window.location.href = 'HTTP://'+window.location.host +'/dashboard'}


	function sendLogin(){

		var LoginForm = document.getElementById('LoginForm');
		formData = new FormData(LoginForm);
		const xhr = new XMLHttpRequest();

		xhr.responseType = "json";
		xhr.open('POST','HTTP://'+window.location.host +':8000/auth/login/');
		xhr.onload = function(){ 
			var response = xhr.response ;
      console.log(response)
			document.cookie = `auth_token=${response['auth_token']}`
      const auth_token = getCookie('auth_token');
      if(auth_token != null && auth_token !== 'undefined' ){
        window.location.href = 'HTTP://'+window.location.host +'/dashboard'
      }

			//window.location.href = '../'
	 	}
	 	xhr.send(formData);

    return false;

	}

	
</script>

</html>

